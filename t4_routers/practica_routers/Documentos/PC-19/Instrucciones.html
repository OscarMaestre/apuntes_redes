<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />
<title>Instrucciones para el ordenador PC-19</title>
<style type="text/css">

/* Minimal style sheet for the HTML output of Docutils.                    */
/*                                                                         */
/* :Author: Günter Milde, based on html4css1.css by David Goodger          */
/* :Id: $Id: minimal.css 8642 2021-03-26 13:51:14Z milde $               */
/* :Copyright: © 2015 Günter Milde.                                        */
/* :License: Released under the terms of the `2-Clause BSD license`_,      */
/*    in short:                                                            */
/*                                                                         */
/*    Copying and distribution of this file, with or without modification, */
/*    are permitted in any medium without royalty provided the copyright   */
/*    notice and this notice are preserved.                                */
/*                                                                         */
/*    This file is offered as-is, without any warranty.                    */
/*                                                                         */
/* .. _2-Clause BSD license: http://www.spdx.org/licenses/BSD-2-Clause     */

/* This CSS2.1_ stylesheet defines rules for Docutils elements without    */
/* HTML equivalent. It is required to make the document semantic visible. */
/*                                                                        */
/* .. _CSS2.1: http://www.w3.org/TR/CSS2                                  */
/* .. _validates: http://jigsaw.w3.org/css-validator/validator$link       */

/* titles */
p.topic-title,
p.admonition-title,
p.system-message-title {
  font-weight: bold;
}
p.sidebar-title,
p.rubric {
  font-weight: bold;
  font-size: larger;
}
p.rubric {
  color: maroon;
}
p.subtitle,
p.section-subtitle,
p.sidebar-subtitle {
  font-weight: bold;
  margin-top: -0.5em;
}
h1 + p.subtitle {
  font-size: 1.6em;
}
h2 + p.section-subtitle, a.toc-backref {
  color: black;
  text-decoration: none;
}

/* Warnings, Errors */
.system-messages h2,
.system-message-title,
span.problematic {
  color: red;
}

/* Inline Literals */
.docutils.literal {
  font-family: monospace;
  white-space: pre-wrap;
}
/* do not wrap at hyphens and similar: */
.literal > span.pre { white-space: nowrap; }

/* Lists */

/* compact and simple lists: no margin between items */
.simple  li, .simple  ul, .simple  ol,
.compact li, .compact ul, .compact ol,
.simple  > li p, dl.simple  > dd,
.compact > li p, dl.compact > dd {
  margin-top: 0;
  margin-bottom: 0;
}
/* Nested Paragraphs */
p:first-child { margin-top: 0; }
p:last-child { margin-bottom: 0; }
td > p, th > p { margin-bottom: 0; }

/* Table of Contents */
.topic.contents { margin: 0.5em 0; }
.topic.contents ul.auto-toc {
  list-style-type: none;
  padding-left: 1.5em;
}

/* Enumerated Lists */
ol.arabic     { list-style: decimal }
ol.loweralpha { list-style: lower-alpha }
ol.upperalpha { list-style: upper-alpha }
ol.lowerroman { list-style: lower-roman }
ol.upperroman { list-style: upper-roman }

/* Definition Lists and Derivatives */
dt .classifier { font-style: italic }
dt .classifier:before {
  font-style: normal;
  margin: 0.5em;
  content: ":";
}
/* Field Lists and similar */
/* bold field name, content starts on the same line */
dl.field-list > dt,
dl.option-list > dt,
dl.docinfo > dt,
dl.footnote > dt,
dl.citation > dt {
  font-weight: bold;
  clear: left;
  float: left;
  margin: 0;
  padding: 0;
  padding-right: 0.5em;
}
/* Offset for field content (corresponds to the --field-name-limit option) */
dl.field-list > dd,
dl.option-list > dd,
dl.docinfo > dd {
  margin-left:  9em; /* ca. 14 chars in the test examples, fit all Docinfo fields */
}
/* start field-body on a new line after long field names */
dl.field-list > dd > *:first-child,
dl.option-list > dd > *:first-child
{
  display: inline-block;
  width: 100%;
  margin: 0;
}
/* field names followed by a colon */
dl.field-list > dt:after,
dl.docinfo > dt:after {
  content: ":";
}

/* Bibliographic Fields (docinfo) */
dl.docinfo pre.address {
  font: inherit;
  margin: 0.5em 0;
}
dl.docinfo > dd.authors > p { margin: 0; }

/* Option Lists */
dl.option-list > dt { font-weight: normal; }
span.option { white-space: nowrap; }

/* Footnotes and Citations  */
dl.footnote.superscript > dd { margin-left: 1em; }
dl.footnote.brackets > dd { margin-left: 2em; }
dl.footnote > dt { font-weight: normal; }
a.footnote-reference.brackets:before,
dt.label > span.brackets:before { content: "["; }
a.footnote-reference.brackets:after,
dt.label > span.brackets:after { content: "]"; }
a.footnote-reference.superscript,
dl.footnote.superscript > dt.label {
  vertical-align: super;
  font-size: small;
}
dt.label > span.fn-backref {
  margin-left: 0.2em;
  font-weight: normal;
}
dt.label > span.fn-backref > a { font-style: italic; }

/* Alignment */
.align-left   {
  text-align: left;
  margin-right: auto;
}
.align-center {
  clear: both;
  text-align: center;
  margin-left: auto;
  margin-right: auto;
}
.align-right  {
  text-align: right;
  margin-left: auto;
}
.align-top    { vertical-align: top; }
.align-middle { vertical-align: middle; }
.align-bottom { vertical-align: bottom; }

/* reset inner alignment in figures and tables */
figure.align-left, figure.align-right,
table.align-left, table.align-center, table.align-right {
  text-align: inherit;
}

/* Text Blocks */
blockquote,
div.topic,
aside.topic {
  margin: 1em 2em;
}
.sidebar,
.admonition,
.system-message {
  border: thin solid;
  margin: 1em 2em;
  padding: 0.5em 1em;
}
.sidebar {
  width: 30%;
  max-width: 26em;
  float: right;
  clear: right;
}
div.line-block { display: block; }
div.line-block div.line-block, pre { margin-left: 2em; }

/* Code line numbers: dropped when copying text from the page */
pre.code .ln { display: none; }
pre.code code:before {
  content: attr(data-lineno); /* …, none) fallback not supported by any browser */
  color: gray;
}

/* Tables */
table {
  border-collapse: collapse;
}
td, th {
  border: thin solid silver;
  padding: 0 1ex;
}
.borderless td, .borderless th {
  border: 0;
  padding: 0;
  padding-right: 0.5em /* separate table cells */
}

table > caption {
  text-align: left;
  margin-top: 0.2em;
  margin-bottom: 0.2em;
}
table.captionbelow {
  caption-side: bottom;
}

/* Document Header and Footer */
header { border-bottom: 1px solid black; }
footer { border-top: 1px solid black; }

/* Images are block-level by default in Docutils */
/* New HTML5 block elements: set display for older browsers */
img, header, section, footer, aside, nav, main, article, figure, video {
  display: block;
}
/* inline images */
p img, p video, figure img, figure video {
  display: inline;
}

</style>
<style type="text/css">

/* CSS31_ style sheet for the output of Docutils HTML writers.             */
/* Rules for easy reading and pre-defined style variants.                  */
/*                                                                         */
/* :Author: Günter Milde, based on html4css1.css by David Goodger          */
/* :Id: $Id: plain.css 8636 2021-03-19 00:23:33Z milde $                                                               */
/* :Copyright: © 2015 Günter Milde.                                        */
/* :License: Released under the terms of the `2-Clause BSD license`_,      */
/*    in short:                                                            */
/*                                                                         */
/*    Copying and distribution of this file, with or without modification, */
/*    are permitted in any medium without royalty provided the copyright   */
/*    notice and this notice are preserved.                                */
/*                                                                         */
/*    This file is offered as-is, without any warranty.                    */
/*                                                                         */
/* .. _2-Clause BSD license: http://www.spdx.org/licenses/BSD-2-Clause     */
/* .. _CSS3: http://www.w3.org/TR/CSS3                                     */


/* Document Structure */
/* ****************** */

/* "page layout" */
body {
  margin: 0;
  background-color: #dbdbdb;
}
main, footer, header {
  line-height:1.3;
  /* avoid long lines --> better reading */
  /* optimum is 45…75 characters/line <http://webtypography.net/2.1.2> */
  /* OTOH: lines should not be too short because of missing hyphenation, */
  max-width: 50rem;
  padding: 1px 2%; /* 1px on top avoids grey bar above title (mozilla) */
  margin: auto;
}
main {
  counter-reset: table figure;
  background-color: white;
}
footer, header {
  font-size: smaller;
  padding: 0.5em 2%;
  border: none;
}

/* Transitions */
hr.docutils {
  width: 80%;
  margin-top: 1em;
  margin-bottom: 1em;
  clear: both;
}

/* Paragraphs */

/* vertical space (parskip) */
p, ol, ul, dl, li, dd,
div.line-block,
div.topic,
table {
  margin-top: 0.5em;
  margin-bottom: 0.5em;
}
p:first-child { margin-top: 0; }
/* (:last-child is new in CSS 3) */
p:last-child  { margin-bottom: 0; }

h1, h2, h3, h4, h5, h6,
dl > dd {
  margin-bottom: 0.5em;
}

/* Lists */
/* ===== */

/* Separate list entries in compound lists */
dl > dd, ol > li,

/* Definition Lists */
/* Indent lists nested in definition lists */
/* (:only-child is new in CSS 3)           */
dd > ul:only-child, dd > ol:only-child { padding-left: 1em; }

/* Description Lists */
/* styled like in most dictionaries, encyclopedias etc. */
dl.description > dt {
  font-weight: bold;
  clear: left;
  float: left;
  margin: 0;
  padding: 0;
  padding-right: 0.5em;
}

/* Field Lists */

/* example for custom field-name width */
dl.field-list.narrow > dd {
  margin-left: 5em;
}
/* run-in: start field-body on same line after long field names */
dl.field-list.run-in > dd p {
  display: block;
}

/* Bibliographic Fields */

/* generally, bibliographic fields use special definition list dl.docinfo */
/* but dedication and abstract are placed into "topic" divs */
div.abstract p.topic-title {
  text-align: center;
}
div.dedication {
  margin: 2em 5em;
  text-align: center;
  font-style: italic;
}
div.dedication p.topic-title {
  font-style: normal;
}

/* Text Blocks */
/* =========== */

/* Literal Blocks */
pre.literal-block, pre.doctest-block,
pre.math, pre.code {
  font-family: monospace;
}

/* Block Quotes */
blockquote > table,
div.topic > table {
  margin-top: 0;
  margin-bottom: 0;
}
blockquote p.attribution,
div.topic p.attribution {
  text-align: right;
  margin-left: 20%;
}

/* Tables */
/* ====== */

/* th { vertical-align: bottom; } */

table tr { text-align: left; }

/* "booktabs" style (no vertical lines) */
table.booktabs {
  border: 0;
  border-top: 2px solid;
  border-bottom: 2px solid;
  border-collapse: collapse;
}
table.booktabs * {
  border: 0;
}
table.booktabs th {
  border-bottom: thin solid;
}

/* numbered tables (counter defined in div.document) */
table.numbered > caption:before {
  counter-increment: table;
  content: "Table " counter(table) ": ";
  font-weight: bold;
}

/* Explicit Markup Blocks */
/* ====================== */

/* Footnotes and Citations */
/* ----------------------- */

/* line on the left */
dl.footnote {
  padding-left: 1ex;
  border-left: solid;
  border-left-width: thin;
}

/* Directives */
/* ---------- */

/* Body Elements */
/* ~~~~~~~~~~~~~ */

/* Images and Figures */

/* let content flow to the side of aligned images and figures */
figure.align-left,
img.align-left,
video.align-left,
object.align-left {
  clear: left;
  float: left;
  margin-right: 1em;
}
figure.align-right,
img.align-right,
video.align-right,
object.align-right {
  clear: right;
  float: right;
  margin-left: 1em;
}
/* Stop floating sidebars, images and figures */
h1, h2, h3, h4, footer, header { clear: both; }

/* Numbered figures */
figure.numbered > figcaption > p:before {
  counter-increment: figure;
  content: "Figure " counter(figure) ": ";
  font-weight: bold;
}

/* Admonitions and System Messages */
.caution p.admonition-title,
.attention p.admonition-title,
.danger p.admonition-title,
.error p.admonition-title,
.warning p.admonition-title,
div.error {
  color: red;
}

/* Sidebar */
/* Move right. In a layout with fixed margins, */
/* it can be moved into the margin.            */
aside.sidebar {
  width: 30%;
  max-width: 26em;
  margin-left: 1em;
  margin-right: -2%;
  background-color: #ffffee;
}

/* Code */
pre.code { padding: 0.7ex }
pre.code, code { background-color: #eeeeee }
/* basic highlighting: for a complete scheme, see */
/* http://docutils.sourceforge.net/sandbox/stylesheets/ */
pre.code .comment, code .comment { color: #5C6576 }
pre.code .keyword, code .keyword { color: #3B0D06; font-weight: bold }
pre.code .literal.string, code .literal.string { color: #0C5404 }
pre.code .name.builtin, code .name.builtin { color: #352B84 }
pre.code .deleted, code .deleted { background-color: #DEB0A1}
pre.code .inserted, code .inserted { background-color: #A3D289}

/* Math */
/* styled separately (see math.css for math-output=HTML) */

/* Epigraph           */
/* Highlights         */
/* Pull-Quote         */
/* Compound Paragraph */
/* Container          */

/* Inline Markup */
/* ============= */

/* Inline Literals                                          */
/* possible values: normal, nowrap, pre, pre-wrap, pre-line */
/*   span.docutils.literal { white-space: pre-wrap; }       */

/* Hyperlink References */
a { text-decoration: none; }

/* External Targets       */
/*   span.target.external */
/* Internal Targets       */
/*   span.target.internal */
/* Footnote References    */
/*   a.footnote-reference */
/* Citation References    */
/*   a.citation-reference */

</style>
</head>
<body>
<main id="instrucciones-para-el-ordenador-pc-19">
<h1 class="title">Instrucciones para el ordenador PC-19</h1>

<p>Junto con este documento se te ha dado una imagen con la topología de una red y una máquina virtual que puedes importar. Importa la máquina y haz 4 clones de manera que tengas en total 5 máquinas virtuales. Es muy recomendable que a cada máquina le pongas un nombre como vamos a ver a continuación.</p>
<p>Obsérva la imagen con detenimiento porque vamos a construir una topologia de red con varios routers y con
enrutamiento estático.</p>
<figure>
<img alt="Red.png" src="Red.png" />
</figure>
<p>Como puedes ver tenemos 6 máquinas:</p>
<ul class="simple">
<li><p>Un cliente llamado &quot;Cliente 1&quot;.</p></li>
<li><p>Un cliente llamado &quot;Cliente 2&quot;.</p></li>
<li><p>Tres router que llamaremos &quot;Izquierda&quot;, &quot;Arriba&quot; y &quot;Abajo&quot;.</p></li>
</ul>
<p>Cliente 1 y Cliente 2 solo van a usar <strong>una tarjeta de red en modo puente</strong>, la <span class="docutils literal">enp0s3</span>. Sin embargo  los router van a tener <strong>tres tarjetas de red en modo puente</strong>. Si estás usando máquinas virtuales clonadas o importadas recuerda <strong>reiniciar las MAC de todas las tarjetas.</strong> A continuación se te indican las direcciones IP y las tarjetas en las que hay que asignarlas.</p>
<ul class="simple">
<li><p>Cliente 1: la tarjeta enp0s3 tiene la IP <strong>1.19.0.2/16</strong></p></li>
<li><p>Cliente 2: la tarjeta enp0s3 tiene la IP <strong>6.19.0.10/16</strong></p></li>
<li><p>Izquierda: la tarjeta enp0s3 tiene la IP <strong>1.19.0.1/16</strong>,la tarjeta enp0s8 tiene la IP <strong>2.19.0.1/16</strong>,la tarjeta enp0s9 tiene la IP <strong>3.19.0.1/16</strong></p></li>
<li><p>Arriba: la tarjeta enp0s3 tiene la IP <strong>Reservada</strong>,la tarjeta enp0s8 tiene la IP <strong>2.19.0.2/16</strong>,la tarjeta enp0s9 tiene la IP <strong>5.19.0.1/16</strong></p></li>
<li><p>Abajo: la tarjeta enp0s3 tiene la IP <strong>6.19.0.1/16</strong>,la tarjeta enp0s8 tiene la IP <strong>3.19.0.2/16</strong>,la tarjeta enp0s9 tiene la IP <strong>5.19.0.2/16</strong></p></li>
</ul>
<section id="ejercicio-1">
<h2>Ejercicio 1</h2>
<p>Configurar las IP, máscaras, gateways y rutas en todas las máquinas de manera que Cliente1 pueda hacer ping a Cliente2 enviando los paquetes por abajo, es decir el camino directo.</p>
</section>
<section id="ejercicio-2">
<h2>Ejercicio 2</h2>
<p>Modifica las rutas de manera que Cliente1 pueda hacer ping a Cliente2 enviando los paquetes por arriba, es decir el camino más largo.</p>
</section>
<section id="ejercicio-3">
<h2>Ejercicio 3</h2>
<p>En el router de arriba hemos dejado una tarjeta sin usar. Intenta conectar con las redes de algún compañero. Para ello, tanto tu compañero como tú tendréis que hacer lo siguiente:</p>
<ul class="simple">
<li><p>Poneros de acuerdo en una red IP para ese segmento. Examinad vuestros números de puesto y usad la dirección de red 30.&lt;numeromayor&gt;.&lt;numeromenor&gt;.0/24. Es decir, si tenéis los números de puesto 7 y 24 deberíais usar la 30.24.7.0/24.</p></li>
<li><p>Pasáos el uno al otro las direcciones de red de vuestros respectivos &quot;Cliente 1&quot; y &quot;Cliente 2&quot;</p></li>
<li><p>Poneros de acuerdo en qué IP usar cada uno en vuestro router de arriba.</p></li>
<li><p>Reconfigura <strong>todos tus router</strong> para añadir en ellos rutas para llegar a las redes de los clientes de tu compañero.</p></li>
</ul>
<p>Este ejercicio demuestra que la configuración estática de rutas solo es razonable para pequeñas redes y con pocos cambios. En el ejercicio siguiente verás como ahorrarte todo este trabajo.</p>
</section>
<section id="ejercicio-4">
<h2>Ejercicio 4</h2>
<p>Reinicia todos los router, lo que borrará todas las rutas. En todos tus router tienes instalado un servicio que permite usar protocolos dinámicos de enrutamientos. Configúralos para que calculen todas las rutas automáticamente.</p>
</section>
<section id="solucion-al-ejercicio-1">
<h2>Solución al ejercicio 1</h2>
<section id="direccionamiento">
<h3>Direccionamiento</h3>
<p>Cliente 1 tendría un fichero de <span class="docutils literal">netplan</span> como este:</p>
<pre class="literal-block">network:
  version: 2
  ethernets:
    enp0s3:
      addresses: [1.19.0.2/16]
      gateway4:  1.19.0.1/16</pre>
<p>Izquierda tendría un fichero de <span class="docutils literal">netplan</span> como este:</p>
<pre class="literal-block">network:
  version: 2
  ethernets:
    enp0s3:
      addresses: [1.19.0.1/16]
    enp0s8:
      addresses: [2.19.0.1/16]
    enp0s9:
      addresses: [3.19.0.1/16]</pre>
<p>Arriba tendría un fichero de <span class="docutils literal">netplan</span> como este:</p>
<pre class="literal-block">network:
  version: 2
  ethernets:
    enp0s8:
      addresses: [2.19.0.2/16]
    enp0s9:
      addresses: [5.19.0.1/16]</pre>
<p>Abajo tendría un fichero de <span class="docutils literal">netplan</span> como este:</p>
<pre class="literal-block">network:
  version: 2
  ethernets:
    enp0s3:
      addresses: [6.19.0.1/16]
    enp0s8:
      addresses: [3.19.0.2/16]
    enp0s9:
      addresses: [5.19.0.2/16]</pre>
<p>Una vez configuradas todas las direcciones IP repasalo todo ejecutando <span class="docutils literal">ip addr</span> <strong>en todas las máquinas</strong> y comprueba que <strong>todo el mundo puede hacer ping a su vecino inmediato</strong>. Si no es así repasa las direcciones y tarjetas y si no ves el error llama al profesor.</p>
</section>
<section id="enrutamiento">
<h3>Enrutamiento</h3>
<p>Antes de empezar, en Linux se debe habilitar el enrutamiento.</p>
<ol class="arabic simple">
<li><p>Escribe <span class="docutils literal">sudo nano /etc/sysctl.conf</span>.</p></li>
<li><p>Busca una línea con el texto <span class="docutils literal">net.ipv4.ip_forward=1</span>.</p></li>
<li><p>Si tiene una almohadilla delante es porque esa línea está comentada y no está activada. Borra el símbolo #, <strong>guarda los cambios</strong> y despues ejecuta <span class="docutils literal">sudo sysctl <span class="pre">-p</span></span> que forzará la recarga del fichero y activará el enrutamiento.</p></li>
</ol>
<p>En todos los router debemos recordar poner tanto las rutas de ida <em>como las rutas de vuelta</em>, así, los comandos a ejecutar serían algo como esto:</p>
<p>En Izquierda podemos ejecutar esto:</p>
<pre class="literal-block">sudo ip route add 6.19.0.0/16 via 3.19.0.2/16</pre>
<p>En Abajo podemos ejecutar esto:</p>
<pre class="literal-block">sudo ip route add 1.19.0.0/16 via 3.19.0.1/16</pre>
</section>
</section>
<section id="solucion-al-ejercicio-2">
<h2>Solución al ejercicio 2</h2>
<section id="id1">
<h3>Direccionamiento</h3>
<p>Los ficheros de <span class="docutils literal">netplan</span> <strong>NO CAMBIAN</strong></p>
</section>
<section id="id2">
<h3>Enrutamiento</h3>
<p>Si ya tienes el enrutamiento activado (ver más arriba) <strong>no hace falta que vuelvas a hacerlo</strong>.</p>
<p>En primer lugar <strong>debemos borrar las rutas anteriores en los router Izquierda y Abajo</strong>. Ademas, de nuevo en todos los router debemos recordar poner tanto las rutas de ida <em>como las rutas de vuelta</em>.</p>
<p>En Izquierda podemos ejecutar esto:</p>
<pre class="literal-block">sudo ip route add 6.19.0.0/16 via 2.19.0.2/16</pre>
<p>En Arriba podemos ejecutar esto:</p>
<pre class="literal-block">sudo ip route add 1.19.0.0/16 via 2.19.0.1/16
sudo ip route add 6.19.0.0/16 via 5.19.0.2/16</pre>
<p>En Abajo podemos ejecutar esto:</p>
<pre class="literal-block">sudo ip route add 1.19.0.0/16 via 5.19.0.1/16</pre>
</section>
</section>
<section id="solucion-al-ejercicio-3">
<h2>Solución al ejercicio 3</h2>
<p>No se da</p>
</section>
<section id="solucion-al-ejercicio-4">
<h2>Solución al ejercicio 4</h2>
<p>En todos los router tendrás que hacer esto:</p>
<ol class="arabic simple">
<li><p>Editar el fichero de configuracion <span class="docutils literal">/etc/frr/daemons</span></p></li>
<li><p>Activar OSPF poniendo <span class="docutils literal">yes</span>  en lugar de <span class="docutils literal">no</span> en esta línea <span class="docutils literal">ospfd=no</span></p></li>
<li><p>Reiniciar el servicio con <span class="docutils literal">sudo service frr restart</span></p></li>
<li><p>Arranca la configuración del router con <span class="docutils literal">sudo vtysh</span></p></li>
<li><p>Introduce los comandos correspondientes a cada router.</p></li>
</ol>
<p>Router izquierda:</p>
<pre class="literal-block">network 1.19.0.0/16 area 1
network 2.19.0.0/16 area 1
network 3.19.0.0/16 area 1</pre>
<p>Router Arriba:</p>
<pre class="literal-block">network 2.19.0.0/16 area 1
network 5.19.0.0/16 area 1</pre>
<p>Router Abajo:</p>
<pre class="literal-block">network 6.19.0.0/16 area 1
network 3.19.0.0/16 area 1
network 5.19.0.0/16 area 1</pre>
</section>
</main>
</body>
</html>
