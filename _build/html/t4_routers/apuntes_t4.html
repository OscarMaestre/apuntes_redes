
<!DOCTYPE html>

<html lang="es">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Tema 5: Configuración y administración básica de routers &#8212; documentación de Apuntes de redes - 1.0</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/alabaster.css" />
    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/translations.js"></script>
    <link rel="index" title="Índice" href="../genindex.html" />
    <link rel="search" title="Búsqueda" href="../search.html" />
    <link rel="next" title="Tema 6:Configuración y administración de protocolos dinámicos" href="../t6_enrutamiento_dinamico/apuntes_t6.html" />
    <link rel="prev" title="Tema 4: Configuración de redes virtuales VLAN" href="../t5_vlans/apuntes_t5.html" />
   
  <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="tema-5-configuracion-y-administracion-basica-de-routers">
<h1>Tema 5: Configuración y administración básica de routers<a class="headerlink" href="#tema-5-configuracion-y-administracion-basica-de-routers" title="Enlazar permanentemente con este título"></a></h1>
<section id="la-capa-de-transporte">
<h2>La capa de transporte<a class="headerlink" href="#la-capa-de-transporte" title="Enlazar permanentemente con este título"></a></h2>
<p>Recordemos la arquitectura de las redes:</p>
<figure class="align-default">
<img alt="../_images/01-osi.png" src="../_images/01-osi.png" />
</figure>
<p>En el dibujo vemos las distintas capas y sabemos que:</p>
<ul class="simple">
<li><p>Las direcciones Ethernet son fijas. Hay una dirección por tarjeta de red.</p></li>
<li><p>Las direcciones IP son configurables. Por cada tarjeta puede haber una IP (o más).</p></li>
</ul>
<p>Tradicionalmente pensamos en el movimiento de datos como si fuera una transacción entre dos máquinas y habrá un paquete que tiene una IP de origen y una de destino.</p>
<p>Supongamos que en un ordenador hay dos servicios. Un servidor Web y un servidor de bases de datos por ejemplo Oracle. Supongamos ahora que otro ordenador quiere conectarse y ver la página web. Supongamos que el cliente tiene la IP 192.168.1.1 y que el servidor tiene la IP 192.168.1.10.</p>
<p>¿Qué ocurre cuando la conexión del 192.168.1.1 (cliente) llega al servidor 192.168.1.10? Con lo que sabemos hasta ahora ¿quien recibe la conexión? ¿El proceso Oracle o el proceso Apache web?</p>
<p>Como en un ordenador puede haber muchos programas enviando y recibiendo datos, ocurre que a cada programa se le asigna un número llamado <strong>PUERTO</strong>. Esto significa que cuando un cliente quiere conectar con un servidor <strong>DEBE PROPORCIONAR UN NÚMERO DE PUERTO</strong>. Los números de puerto y la gestión de esas múltiples conexiones se hace en la capa de transporte.</p>
<p>Ocurre por tanto, que cualquier bloque de trama que envíamos tiene en realidad <em>al menos</em> cuatro elementos:</p>
<ol class="arabic simple">
<li><p>IP de origen</p></li>
<li><p>Puerto de origen</p></li>
<li><p>IP de destino.</p></li>
<li><p>Puerto de destino</p></li>
</ol>
<p>Tenemos que tener presente que a partir de ahora, la estructura de cualquier paquete es algo como esto:</p>
<figure class="align-default">
<img alt="../_images/02-puertos.png" src="../_images/02-puertos.png" />
</figure>
<p>Un puerto, en realidad es un número. El sistema operativo usa ese número para saber a qué programa tiene que darle un paquete entrante. Cuando un programa servidor (como Apache) arranca intenta que el sistema operativo le dé un puerto fijo. Si ningún otro programa lo usa, el sistema operativo se lo dará y a partir de ese momento, los paquetes entrantes cuyo puerto de destino sea ese se entregarán al software de Apache.</p>
<ul class="simple">
<li><p>Los servidores que aceptan conexiones <strong>siempre escuchan en el mismo puerto</strong>. De hecho hay algunos números de puerto estandarizados. Por ejemplo el 80 TCP es de HTTP y el 443 TCP es de HTTPS.</p></li>
<li><p>Los clientes no siempre usan el mismo número. De hecho los eligen al azar con valores entre 49152 y 65535.</p></li>
</ul>
<p>¿Qué es eso de TCP? Resulta que en realidad hay dos protocolos de transporte bastante conocidos (en realidad más pero no los mencionaremos)</p>
<ul class="simple">
<li><p>TCP es un protocolo fiable. Para conseguir fiabilidad envia confirmaciones de recepción de mensajes. El problema es que TCP es más lento que su alternativa.</p></li>
<li><p>UDP es no confiable. Algunas aplicaciones (como video conferencia) necesitan la velocidad extra a toda costa y no importa si se pierden algunos datos.</p></li>
</ul>
<p>Se debe tener también presente algunas cosas sobre los protocolos:</p>
<ul class="simple">
<li><p>Cada programador elige el protocolo de su programa: <strong>no lo podemos cambiar</strong></p></li>
<li><p>Aparte de las IP, los puertos y los orígenes y destino, <strong>el sentido del tráfico importa</strong>.</p></li>
<li><p>En las redes, los estándares son públicos, abiertos y gratuitos. Estos estándares se denominan RFCs (Request For Comments)</p></li>
</ul>
</section>
<section id="componentes-del-router">
<h2>Componentes del router.<a class="headerlink" href="#componentes-del-router" title="Enlazar permanentemente con este título"></a></h2>
<p>Los router modernos son verdaderos ordenadores en sí mismos:</p>
<ul class="simple">
<li><p>Microprocesador: Los Cisco llevan MPC (PowerPC). En los domésticos se ve procesadores embebidos en muchos casos MIPS.</p></li>
<li><p>Sistema operativo: En Cisco está IOS. En los domésticos los sistemas son propietarios.</p></li>
<li><p>RAM: los router/switch modernos almacenan datos temporales como por ejemplo la tabla de MACs.</p></li>
<li><p>ROM: en realidad hoy en día suelen ser EEPROM. Alojan un programa llamado comúnmente el firmware.</p></li>
<li><p>NVRAM: en ella se almacena información como la VLANs. Solo en dispositivos de gama media/alta.</p></li>
<li><p>E/S: normalmente solo a través de los puertos de red.</p></li>
</ul>
<p>En la figura siguiente podemos ver un router doméstico abierto:</p>
<figure class="align-default">
<img alt="../_images/03-router-abierto.jpg" src="../_images/03-router-abierto.jpg" />
</figure>
<p>El diagrama de bloques sería más o menos así:</p>
<figure class="align-default">
<img alt="../_images/04-descomposicion.png" src="../_images/04-descomposicion.png" />
</figure>
<p>Los router domésticos a nivel interno no solamente tienen un sistema operativo sino también algunos parámetros configurables:</p>
<ul class="simple">
<li><p>IP y máscara. Por defecto, en muchos hogares es la 192.168.1.1 con máscara 255.255.255.0</p></li>
<li><p>Rango de direcciones DHCP. DHCP se explicará en profundidad en segundo curso, en el módulo «Servicios de red».</p></li>
</ul>
</section>
<section id="los-routers-en-las-lan-y-en-las-wan">
<h2>Los routers en las LAN y en las WAN.<a class="headerlink" href="#los-routers-en-las-lan-y-en-las-wan" title="Enlazar permanentemente con este título"></a></h2>
<p>En las redes LAN el router toma decisiones sencillas. En líneas generales solo deciden «¿se envía este paquete al otro lado o no?».</p>
<p>En redes WAN, los routers tienen conexión con muchas otras redes. Al tener muchas redes, estos routers tienen que «intentar averiguar todas las conexiones y decidir cuales son los mejores caminos».</p>
<section id="el-proceso-de-nat-paso-a-paso">
<h3>El proceso de NAT paso a paso<a class="headerlink" href="#el-proceso-de-nat-paso-a-paso" title="Enlazar permanentemente con este título"></a></h3>
<p>Paso 1: un usuario quiere iniciar una conexión y conectarse a un servidor en otro lugar remoto.</p>
<figure class="align-default">
<img alt="../_images/nat01.png" src="../_images/nat01.png" />
</figure>
<p>Paso 2: el usuario pide al servidor la IP pública de su router y usando su programa intenta conectarse a la IP pública del otro router y al puerto del juego o servicio. El puerto de origen se elige al azar.</p>
<figure class="align-default">
<img alt="../_images/nat02.png" src="../_images/nat02.png" />
</figure>
<p>Paso 3: el paquete llega al router. El router observa que el paquete va al exterior. Como no se pueden usar IPs privadas en el exterior, el router <strong>CAMBIA LA IP DE ORIGEN Y TOMA NOTA DE ESA TRADUCCIÓN POR SI EN EL FUTURO SE NECESITA ESA INFORMACIÓN</strong>.</p>
<figure class="align-default">
<img alt="../_images/nat03.png" src="../_images/nat03.png" />
</figure>
<p>Paso 4: el paquete (con la IP de origen cambiada) viaja por la red y llega al router de destino. Como los router <strong>por defecto no aceptan conexiones entrantes, en principio el paquete no entraría</strong> Es necesario que primero el router derecho tenga <em>el puerto 6003 abierto.</em> Abrir un puerto consiste en poner una regla que indique que si llega una conexión entrante iniciada en el exterior se va a dejar pasar enviando el paquete a una cierta IP.</p>
<figure class="align-default">
<img alt="../_images/nat04.png" src="../_images/nat04.png" />
</figure>
<p>Paso 5: si hubiera la regla correcta, el paquete entrará pero con la IP de destino modificada.
.. figure:: img/nat05.png</p>
<p>Paso 6: el paquete que intentaba iniciar la conexión <strong>llega correctamente a su destino</strong>.
.. figure:: img/nat06.png</p>
<p>Paso 7: el servidor va a responder y genera un paquete de respuesta.</p>
<figure class="align-default">
<img alt="../_images/nat07.png" src="../_images/nat07.png" />
</figure>
<p>Paso 8: el paquete llega al router <strong>que vuelve a modificar la IP de origen porque no se aceptan IPs privadas en Internet.</strong> Por supuesto, el router vuelve a apuntar esa traducción.</p>
<figure class="align-default">
<img alt="../_images/nat08.png" src="../_images/nat08.png" />
</figure>
<p>Paso 9: el paquete intenta entrar. Lo primero que podríamos pensar es que el paquete no entrará, sin embargo <strong>SÍ VA A CONSEGUIR ENTRAR</strong></p>
<figure class="align-default">
<img alt="../_images/nat09.png" src="../_images/nat09.png" />
</figure>
<p>Paso 10: el router observa que el paquete <strong>coincide perfectamente</strong> con la información de una traducción que se hizo en el pasado. Es decir <strong>el paquete puede pasar</strong>. De nuevo, se vuelve a cambiar la IP de destino y el paquete se inyecta en la red izquierda.
.. figure:: img/nat10.png</p>
<p>Paso 10b: se modifica la IP y se envía al interior.</p>
<figure class="align-default">
<img alt="../_images/nat11.png" src="../_images/nat11.png" />
</figure>
<p>Paso 11: el paquete <strong>llega a su destino</strong></p>
<figure class="align-default">
<img alt="../_images/nat12.png" src="../_images/nat12.png" />
</figure>
</section>
</section>
<section id="formas-de-conexion-al-router-para-su-configuracion-inicial">
<h2>Formas de conexión al router para su configuración inicial.<a class="headerlink" href="#formas-de-conexion-al-router-para-su-configuracion-inicial" title="Enlazar permanentemente con este título"></a></h2>
<section id="routers-domesticos">
<h3>Routers domésticos<a class="headerlink" href="#routers-domesticos" title="Enlazar permanentemente con este título"></a></h3>
</section>
<section id="routers-de-gama-alta">
<h3>Routers de gama alta<a class="headerlink" href="#routers-de-gama-alta" title="Enlazar permanentemente con este título"></a></h3>
</section>
</section>
<section id="comandos-para-configuracion-del-router">
<h2>Comandos para configuración del router.<a class="headerlink" href="#comandos-para-configuracion-del-router" title="Enlazar permanentemente con este título"></a></h2>
<section id="poner-clave-al-modo-administrador">
<h3>Poner clave al modo administrador<a class="headerlink" href="#poner-clave-al-modo-administrador" title="Enlazar permanentemente con este título"></a></h3>
</section>
<section id="poner-clave-al-acceso-por-telnet">
<h3>Poner clave al acceso por telnet<a class="headerlink" href="#poner-clave-al-acceso-por-telnet" title="Enlazar permanentemente con este título"></a></h3>
</section>
<section id="poner-clave-al-acceso-por-cable-de-consola">
<h3>Poner clave al acceso por cable de consola<a class="headerlink" href="#poner-clave-al-acceso-por-cable-de-consola" title="Enlazar permanentemente con este título"></a></h3>
</section>
<section id="quitar-una-clave-o-valor-de-configuracion">
<h3>Quitar una clave o valor de configuración<a class="headerlink" href="#quitar-una-clave-o-valor-de-configuracion" title="Enlazar permanentemente con este título"></a></h3>
</section>
</section>
<section id="comandos-para-administracion-del-router">
<h2>Comandos para administración del router.<a class="headerlink" href="#comandos-para-administracion-del-router" title="Enlazar permanentemente con este título"></a></h2>
<section id="poner-una-ip-a-una-interfaz">
<h3>Poner una IP a una interfaz<a class="headerlink" href="#poner-una-ip-a-una-interfaz" title="Enlazar permanentemente con este título"></a></h3>
</section>
<section id="configurar-dhcp">
<h3>Configurar DHCP<a class="headerlink" href="#configurar-dhcp" title="Enlazar permanentemente con este título"></a></h3>
</section>
<section id="excluir-direcciones-de-la-asignacion-dhcp">
<h3>Excluir direcciones de la asignación DHCP<a class="headerlink" href="#excluir-direcciones-de-la-asignacion-dhcp" title="Enlazar permanentemente con este título"></a></h3>
</section>
<section id="activar-nat-en-un-router">
<h3>Activar NAT en un router<a class="headerlink" href="#activar-nat-en-un-router" title="Enlazar permanentemente con este título"></a></h3>
</section>
</section>
<section id="configuracion-del-enrutamiento-estatico">
<h2>Configuración del enrutamiento estático.<a class="headerlink" href="#configuracion-del-enrutamiento-estatico" title="Enlazar permanentemente con este título"></a></h2>
</section>
<section id="definicion-y-ubicacion-de-listas-de-control-de-acceso-acls">
<h2>Definición y ubicación de listas de control de acceso (ACLs).<a class="headerlink" href="#definicion-y-ubicacion-de-listas-de-control-de-acceso-acls" title="Enlazar permanentemente con este título"></a></h2>
</section>
</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="../index.html">Apuntes de redes</a></h1>








<h3>Navegación</h3>
<p class="caption" role="heading"><span class="caption-text">Índice:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../t1_caracterizacion_redes/apuntes_t1.html">Tema 1:Caracterización de redes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../t2_integracion_elementos/apuntes_t2.html">Tema 2:Integración de elementos en una red</a></li>
<li class="toctree-l1"><a class="reference internal" href="../t3_conmutadores/apuntes_t3.html">Tema 3:Configuración y administración de conmutadores</a></li>
<li class="toctree-l1"><a class="reference internal" href="../t5_vlans/apuntes_t5.html">Tema 4: Configuración de redes virtuales VLAN</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Tema 5: Configuración y administración básica de routers</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#la-capa-de-transporte">La capa de transporte</a></li>
<li class="toctree-l2"><a class="reference internal" href="#componentes-del-router">Componentes del router.</a></li>
<li class="toctree-l2"><a class="reference internal" href="#los-routers-en-las-lan-y-en-las-wan">Los routers en las LAN y en las WAN.</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#el-proceso-de-nat-paso-a-paso">El proceso de NAT paso a paso</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#formas-de-conexion-al-router-para-su-configuracion-inicial">Formas de conexión al router para su configuración inicial.</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#routers-domesticos">Routers domésticos</a></li>
<li class="toctree-l3"><a class="reference internal" href="#routers-de-gama-alta">Routers de gama alta</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#comandos-para-configuracion-del-router">Comandos para configuración del router.</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#poner-clave-al-modo-administrador">Poner clave al modo administrador</a></li>
<li class="toctree-l3"><a class="reference internal" href="#poner-clave-al-acceso-por-telnet">Poner clave al acceso por telnet</a></li>
<li class="toctree-l3"><a class="reference internal" href="#poner-clave-al-acceso-por-cable-de-consola">Poner clave al acceso por cable de consola</a></li>
<li class="toctree-l3"><a class="reference internal" href="#quitar-una-clave-o-valor-de-configuracion">Quitar una clave o valor de configuración</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#comandos-para-administracion-del-router">Comandos para administración del router.</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#poner-una-ip-a-una-interfaz">Poner una IP a una interfaz</a></li>
<li class="toctree-l3"><a class="reference internal" href="#configurar-dhcp">Configurar DHCP</a></li>
<li class="toctree-l3"><a class="reference internal" href="#excluir-direcciones-de-la-asignacion-dhcp">Excluir direcciones de la asignación DHCP</a></li>
<li class="toctree-l3"><a class="reference internal" href="#activar-nat-en-un-router">Activar NAT en un router</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#configuracion-del-enrutamiento-estatico">Configuración del enrutamiento estático.</a></li>
<li class="toctree-l2"><a class="reference internal" href="#definicion-y-ubicacion-de-listas-de-control-de-acceso-acls">Definición y ubicación de listas de control de acceso (ACLs).</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../t6_enrutamiento_dinamico/apuntes_t6.html">Tema 6:Configuración y administración de protocolos dinámicos</a></li>
<li class="toctree-l1"><a class="reference internal" href="../t7_acceso_internet/apuntes_t7.html">Tema 7: Configuración del acceso a Internet desde una LAN</a></li>
<li class="toctree-l1"><a class="reference internal" href="../anexos/t1_ejercicios.html">Anexo: Ejercicios propuestos para el tema 1</a></li>
<li class="toctree-l1"><a class="reference internal" href="../t2_integracion_elementos/ejercicios_switches/ejercicios_dos_switches.html">Anexo: ejercicios con tablas MAC de switches</a></li>
<li class="toctree-l1"><a class="reference internal" href="../t2_integracion_elementos/ejercicios_subredes_ipv4/rangos_direcciones.html">Anexo: ejercicios sobre rangos de direcciones</a></li>
<li class="toctree-l1"><a class="reference internal" href="../t2_integracion_elementos/ejercicios_subredes/ejercicios_calculo_subredes.html">Anexo: cálculo de subredes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../t2_integracion_elementos/ejercicios_subredes_ipv4/ejercicios_dos_router.html">Anexo: ejercicios de enrutamiento</a></li>
<li class="toctree-l1"><a class="reference internal" href="../t2_integracion_elementos/ejercicios_subredes_ipv4/ejercicios_3_router_caso_a.html">Anexo: ejercicios de enrutamiento con 3 routers (caso 1)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../t2_integracion_elementos/ejerciciosipv6/ejercicios_ipv6.html">Anexo: Ejercicios sobre compresión de direcciones IPv6</a></li>
<li class="toctree-l1"><a class="reference internal" href="../t2_integracion_elementos/ejerciciosipv6/ejercicios_ipv6.html#soluciones-a-compresion-de-direcciones-ipv6">Soluciones a compresión de direcciones IPv6</a></li>
<li class="toctree-l1"><a class="reference internal" href="../t2_integracion_elementos/ejercicios_ips/clasificacion_ipv6.html">Anexo: ejercicios sobre clasificación de direcciones IPv6</a></li>
<li class="toctree-l1"><a class="reference internal" href="../t2_integracion_elementos/ejercicios_ips/clasificacion_ipv6.html#soluciones-a-la-clasificaciones-de-direcciones-ipv6">Soluciones a la clasificaciones de direcciones IPv6</a></li>
<li class="toctree-l1"><a class="reference internal" href="../t3_conmutadores/ejercicios/ejercicios_switches.html">Anexo al tema 3: Ejercicios sobre comandos Cisco en switches</a></li>
<li class="toctree-l1"><a class="reference internal" href="../t3_conmutadores/simuladorstp/stp1.html">Anexo al tema 3:Ejercicios STP</a></li>
<li class="toctree-l1"><a class="reference internal" href="../t5_vlans/ejercicios_vlans/ejercicios_vlans.html">Ejercicios con VLANS y VTP</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../index.html">Documentation overview</a><ul>
      <li>Previous: <a href="../t5_vlans/apuntes_t5.html" title="capítulo anterior">Tema 4: Configuración de redes virtuales VLAN</a></li>
      <li>Next: <a href="../t6_enrutamiento_dinamico/apuntes_t6.html" title="próximo capítulo">Tema 6:Configuración y administración de protocolos dinámicos</a></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Búsqueda rápida</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Ir a" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2021, Oscar G. G..
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 4.2.0</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
      |
      <a href="../_sources/t4_routers/apuntes_t4.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>